# 组合模式
## 概念
组合模式就是用小的子对象来构建更大的对象，用孙子对象构建子对象...
由此拆分问题。

## 用途
+ 可以表示树形结构，展示“部分-整体”的结构
+ 可以通过对象的多态性表现，使的用户对单个对象和组合对象的使用具有一致性。

## 传递过程
以宏命令为例，请求从树最顶端的对象往下传递，如果当前处理请求的对象是叶对象(普通子命令)，叶对象自身会对请求做相应的处理；
如果当前请求的对象是组合对象（宏命令），组合对象会遍历它属下的子节点，将请求继续传递给孙子节点。

实例：
万能遥控器，拥有以下功能：
+ 开空调
+ 打开电视和音响
+ 关门、开电脑、登陆QQ
>具体实现请参考ep7.html

从这个例子可看出，基本对象可组合成更复杂的组合对象，组合对象又可以被组合，
这样不断递归下去，树可以支持任意多的复杂度。
使用者不需要关心内在细节，每当对最上层对象进行请求时，实际上是对整个树实现深度优先搜索；

## 注意
1.组合模式不是父子关系

组合模式的树型结构容易让人误以为组合对象和叶对象是父子关系，这是不正确的。

为了方便描述，本章有时候把上下级对象称为父子节点，但大家要知道，它们并非真正意义
上的父子关系。

2.对叶对象操作的一致性

组合模式除了要求组合对象和叶对象拥有相同的接口之外，还有一个必要条件，就是对一组
叶对象的操作必须具有一致性。

比如公司要给全体员工发放元旦的过节费1000 块，这个场景可以运用组合模式，但如果公
司给今天过生日的员工发送一封生日祝福的邮件，组合模式在这里就没有用武之地了，除非先把
今天过生日的员工挑选出来。只有用一致的方式对待列表中的每个叶对象的时候，才适合使用组
合模式。

3.双向映射关系

发放过节费的通知步骤是从公司到各个部门，再到各个小组，最后到每个员工的邮箱里。这
本身是一个组合模式的好例子，但要考虑的一种情况是，也许某些员工属于多个组织架构。比如
某位架构师既隶属于开发组，又隶属于架构组，对象之间的关系并不是严格意义上的层次结构，
在这种情况下，是不适合使用组合模式的，该架构师很可能会收到两份过节费。

这种复合情况下我们必须给父节点和子节点建立双向映射关系，一个简单的方法是给小组和员
工对象都增加集合来保存对方的引用。但是这种相互间的引用相当复杂，而且对象之间产生了过多
的耦合性，修改或者删除一个对象都变得困难，此时我们可以引入中介者模式来管理这些对象。

4.用职责链模式提高组合模式性能

如果树的结构比较复杂,在遍历树的过程中，性能方面也许不够理想,有一种现
成的方案是借助职责链模式